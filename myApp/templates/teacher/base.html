<!DOCTYPE html>
<!-- TEACHER_BASE_TEMPLATE_LOADED_DEBUG_MARKER_v2 -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Fluentory - Teacher{% endblock %}</title>
    <script>
        // Set theme attribute IMMEDIATELY and synchronously before anything else
        (function() {
            const stored = localStorage.getItem('fluentory-theme');
            const theme = stored === 'light' ? 'light' : (stored === 'dark' ? 'dark' : 
                (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark'));
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <script>
        // Set Tailwind config BEFORE loading Tailwind CDN
        tailwind.config = {
            darkMode: ['selector', '[data-theme="dark"]'],
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
                    },
                    colors: {
                        'teal-dark': '#04363a',
                        'teal-medium': '#254346',
                        'teal-light': '#00655F',
                        'green-accent': '#82C293',
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    {% include 'partials/theme_variables.html' %}
    {% include 'partials/theme_script.html' %}
    {% include 'partials/modal.html' %}
    <style>
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        body {
            /* Black-dominant background with subtle teal glow - matches Admin */
            background: linear-gradient(to bottom, #000000 0%, #021a1c 20%, #0a1f22 50%, #021a1c 80%, #000000 100%);
            min-height: 100vh;
        }
        
        [data-theme="light"] body {
            background: linear-gradient(to bottom, var(--bg-gradient-top) 0%, var(--bg-gradient-middle) 50%, var(--bg-gradient-bottom) 100%);
        }
        
        /* Light mode: Ensure navbar has proper shadow and crisp appearance */
        [data-theme="light"] nav {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 0 rgba(255, 255, 255, 0.5) inset;
        }
        
        /* Dark mode: Subtle glow effect */
        [data-theme="dark"] nav {
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        /* Logo polish - ensure it's always crisp */
        .teacher-logo {
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        /* Light mode: Sidebar contrast */
        [data-theme="light"] aside {
            box-shadow: 1px 0 3px rgba(0, 0, 0, 0.05);
        }
        
        /* Light mode: Active sidebar item - better contrast */
        [data-theme="light"] .sidebar-link.active {
            background-color: rgba(95, 163, 114, 0.08) !important;
            color: #5FA372 !important;
        }
        
        /* Light mode: Sidebar hover */
        [data-theme="light"] .sidebar-link:hover:not(.active) {
            background-color: rgba(10, 31, 31, 0.04) !important;
            color: #5FA372 !important;
        }
        
        /* Light mode: Icon containers - keep green but more visible */
        [data-theme="light"] .bg-gradient-to-br.from-\[#82C293\]\/20 {
            background: linear-gradient(to bottom right, rgba(95, 163, 114, 0.15), rgba(95, 163, 114, 0.08)) !important;
        }
        
        /* Light mode: Icons in stat cards - darker green for better contrast */
        [data-theme="light"] .text-\[#82C293\] {
            color: #5FA372 !important;
        }
        
        /* Light mode: Section icons */
        [data-theme="light"] .text-\[#82C293\]\/80 {
            color: #5FA372 !important;
        }
        
        /* Light mode: Links */
        [data-theme="light"] a.text-\[#82C293\] {
            color: #5FA372 !important;
        }
        
        [data-theme="light"] a.text-\[#82C293\]:hover {
            color: #4A8F5F !important;
        }
        
        /* Light mode: Fix nested card backgrounds - use light gray instead of transparent */
        [data-theme="light"] .glass-card > div > div[style*="background-color: rgba(255,255,255,0.03)"] {
            background-color: #FAFCFB !important;
            border-color: rgba(10, 31, 31, 0.08) !important;
        }
        
        [data-theme="light"] .glass-card > div > div[style*="background-color: rgba(255,255,255,0.03)"]:hover {
            background-color: #F5F7F6 !important;
            border-color: rgba(95, 163, 114, 0.3) !important;
        }
        
        /* Light mode: Ensure stat card numbers are dark */
        [data-theme="light"] .text-4xl.font-extrabold {
            color: var(--text-primary) !important;
        }
        
        /* Light mode: Stat card labels */
        [data-theme="light"] .text-xs.font-medium[style*="color: var(--text-muted)"] {
            color: var(--text-tertiary) !important;
        }
        
        /* Light mode: Text in empty states - ensure readability */
        [data-theme="light"] [style*="opacity: 0.3"] {
            opacity: 0.5 !important;
            color: var(--text-muted) !important;
        }
        
        [data-theme="light"] [style*="opacity: 0.7"] {
            opacity: 0.75 !important;
            color: var(--text-tertiary) !important;
        }
        
        /* Light mode: Empty state icons - visible but subtle */
        [data-theme="light"] .text-5xl[style*="color: var(--text-muted)"] {
            color: var(--text-tertiary) !important;
            opacity: 0.4 !important;
        }
        
        /* Light mode: Primary buttons - solid green with white text */
        [data-theme="light"] .bg-gradient-to-r.from-\[#82C293\] {
            background: linear-gradient(to right, #5FA372, #4A8F5F, #5FA372) !important;
            color: #FFFFFF !important;
            font-weight: 600 !important;
        }
        
        [data-theme="light"] .bg-gradient-to-r.from-\[#82C293\]:hover {
            background: linear-gradient(to right, #4A8F5F, #3D7A4F, #4A8F5F) !important;
            box-shadow: 0 4px 12px rgba(95, 163, 114, 0.3) !important;
        }
        
        /* Light mode: Premium buttons - enhanced contrast */
        [data-theme="light"] .btn-primary,
        /* Light mode: Use exact same styling as Update Course button */
        [data-theme="light"] .btn-cta-primary {
            background: linear-gradient(to right, #047857, #065f46, #047857) !important;
            background-size: 200% 100%;
            color: #FFFFFF !important;
            box-shadow: 0 4px 14px rgba(4, 120, 87, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1) inset !important;
            border: none !important;
        }
        
        /* Ensure button text and icons are white in light mode (same as Update Course) */
        [data-theme="light"] .btn-primary,
        [data-theme="light"] .btn-primary *,
        [data-theme="light"] .btn-primary i,
        [data-theme="light"] .btn-cta-primary,
        [data-theme="light"] .btn-cta-primary *,
        [data-theme="light"] .btn-cta-primary i {
            color: #FFFFFF !important;
        }
        
        /* Light mode hover: exact same as Update Course */
        [data-theme="light"] .btn-primary:hover:not(:disabled),
        [data-theme="light"] .btn-cta-primary:hover:not(:disabled) {
            box-shadow: 0 8px 20px rgba(5, 150, 105, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.15) inset !important;
            background: linear-gradient(to right, #047857, #065f46, #047857) !important;
        }
        
        /* Light mode: Ensure dropdown selected text is visible */
        [data-theme="light"] .form-select option {
            background-color: #FFFFFF !important;
            color: #0f172a !important;
        }
        
        [data-theme="light"] .form-select {
            background-color: #FFFFFF !important;
            color: #0f172a !important;
        }
        
        /* Light mode: Enhanced input readability */
        [data-theme="light"] .form-input,
        [data-theme="light"] .form-textarea {
            background-color: #FFFFFF !important;
            border-color: #e2e8f0 !important;
            color: #0f172a !important;
        }
        
        [data-theme="light"] .form-input::placeholder,
        [data-theme="light"] .form-textarea::placeholder {
            color: #64748b !important; /* slate-500 - more visible */
        }
        
        /* Fix all washed out text in light mode - ensure readable contrast */
        [data-theme="light"] .text-slate-100\/50,
        [data-theme="light"] .text-white\/60 {
            color: rgb(71 85 105) !important; /* slate-600 */
        }
        
        [data-theme="light"] .text-slate-400 {
            color: rgb(71 85 105) !important; /* slate-600 for better readability */
        }
        
        /* Light mode: Ensure helper text is always readable */
        [data-theme="light"] .form-helper {
            color: rgb(71 85 105) !important; /* slate-600 */
        }
        
        /* Light mode: Ensure all subtitle and descriptive text is readable */
        [data-theme="light"] p.text-slate-600,
        [data-theme="light"] p.text-slate-400,
        [data-theme="light"] .text-slate-600:not(.dark),
        [data-theme="light"] .text-slate-400:not(.dark) {
            color: rgb(51 65 85) !important; /* slate-700 - darker and more readable */
        }
        
        /* Ensure page subtitles are always readable in light mode - HIGH SPECIFICITY */
        [data-theme="light"] div.mb-10 > p,
        [data-theme="light"] div.mb-10 > p.text-base,
        [data-theme="light"] div.mb-10 > p.text-sm,
        [data-theme="light"] div.mb-10 > p.text-lg,
        [data-theme="light"] .mb-10 p.text-base,
        [data-theme="light"] .mb-10 p.text-sm,
        [data-theme="light"] .mb-10 p.text-lg {
            color: rgb(51 65 85) !important; /* slate-700 */
        }
        
        /* Force readable subtitle text in light mode */
        [data-theme="light"] p.text-base.text-slate-600,
        [data-theme="light"] p.text-lg.text-slate-600,
        [data-theme="light"] p.text-base.text-slate-400,
        [data-theme="light"] p.text-lg.text-slate-400 {
            color: rgb(51 65 85) !important; /* slate-700 */
        }
        
        /* ============================================
           GLOBAL TEACHER CONTENT TYPOGRAPHY BASELINE
           ============================================ */
        .teacher-content {
            color: #0f172a !important; /* slate-900 for light mode */
        }
        
        .dark .teacher-content,
        [data-theme="dark"] .teacher-content {
            color: #f1f5f9 !important; /* slate-100 for dark mode */
        }
        
        /* Aggressive overrides: fix too-light text in light mode */
        [data-theme="light"] .teacher-content [class*="text-white"],
        [data-theme="light"] .teacher-content .text-white,
        [data-theme="light"] .teacher-content [class*="text-white/10"],
        [data-theme="light"] .teacher-content [class*="text-white/20"],
        [data-theme="light"] .teacher-content [class*="text-white/30"],
        [data-theme="light"] .teacher-content [class*="text-white/40"],
        [data-theme="light"] .teacher-content [class*="text-white/50"],
        [data-theme="light"] .teacher-content [class*="text-white/60"],
        [data-theme="light"] .teacher-content [class*="text-white/70"],
        [data-theme="light"] .teacher-content [class*="text-white/80"],
        [data-theme="light"] .teacher-content [class*="text-white/90"] {
            color: #475569 !important; /* slate-600 */
        }
        
        /* Exception: Green gradient buttons must keep white text - HIGH PRIORITY */
        [data-theme="light"] .teacher-content a[class*="bg-gradient-to-r"][class*="emerald"],
        [data-theme="light"] .teacher-content a[class*="bg-gradient-to-r"][class*="emerald"] *,
        [data-theme="light"] .teacher-content a[class*="bg-gradient-to-r"][class*="emerald"] i,
        [data-theme="light"] .teacher-content a[class*="bg-gradient-to-r"][class*="emerald"] span,
        [data-theme="light"] .teacher-content button[class*="bg-gradient-to-r"][class*="emerald"],
        [data-theme="light"] .teacher-content button[class*="bg-gradient-to-r"][class*="emerald"] *,
        [data-theme="light"] .teacher-content button[class*="bg-gradient-to-r"][class*="emerald"] i,
        [data-theme="light"] .teacher-content button[class*="bg-gradient-to-r"][class*="emerald"] span,
        [data-theme="light"] .teacher-content a[class*="from-emerald-700"],
        [data-theme="light"] .teacher-content a[class*="from-emerald-700"] *,
        [data-theme="light"] .teacher-content a[class*="from-emerald-700"] i,
        [data-theme="light"] .teacher-content a[class*="from-emerald-700"] span,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"],
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] *,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] i,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] span,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"],
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"] *,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"] i,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"] span,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"],
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"] *,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"] i,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"] span {
            color: #FFFFFF !important; /* Force white text on green buttons */
        }
        
        [data-theme="light"] .teacher-content .text-slate-100,
        [data-theme="light"] .teacher-content .text-slate-200,
        [data-theme="light"] .teacher-content .text-slate-300,
        [data-theme="light"] .teacher-content [class*="text-slate-100"],
        [data-theme="light"] .teacher-content [class*="text-slate-200"],
        [data-theme="light"] .teacher-content [class*="text-slate-300"] {
            color: #475569 !important; /* slate-600 */
        }
        
        /* Headings */
        [data-theme="light"] .teacher-content h1,
        [data-theme="light"] .teacher-content h2,
        [data-theme="light"] .teacher-content h3,
        [data-theme="light"] .teacher-content h4,
        [data-theme="light"] .teacher-content h5,
        [data-theme="light"] .teacher-content h6 {
            color: #0f172a !important; /* slate-900 */
        }
        
        /* Paragraphs and body text without explicit text classes */
        [data-theme="light"] .teacher-content p:not([class*="text-"]):not([class*="dark:"]),
        [data-theme="light"] .teacher-content span:not([class*="text-"]):not([class*="dark:"]),
        [data-theme="light"] .teacher-content div:not([class*="text-"]):not([class*="dark:"]) {
            color: #334155 !important; /* slate-700 */
        }
        
        /* Spans */
        [data-theme="light"] .teacher-content span[class*="text-white"],
        [data-theme="light"] .teacher-content span.text-white,
        [data-theme="light"] .teacher-content span[class*="text-slate-200"],
        [data-theme="light"] .teacher-content span[class*="text-slate-300"],
        [data-theme="light"] .teacher-content span[class*="text-slate-400"],
        [data-theme="light"] .teacher-content span[class*="text-slate-500"] {
            color: #0f172a !important; /* slate-900 */
        }
        
        /* Card text readability */
        [data-theme="light"] .teacher-content .glass-card,
        [data-theme="light"] .teacher-content [class*="bg-white"],
        [data-theme="light"] .teacher-content [class*="bg-slate-50"],
        [data-theme="light"] .teacher-content [class*="bg-slate-100"] {
            color: #0f172a !important;
        }
        
        /* Labels and helper text */
        [data-theme="light"] .teacher-content label:not([class*="text-"]),
        [data-theme="light"] .teacher-content small:not([class*="text-"]) {
            color: #475569 !important; /* slate-600 */
        }
        
        /* Icons */
        [data-theme="light"] .teacher-content i.fas,
        [data-theme="light"] .teacher-content i.far,
        [data-theme="light"] .teacher-content i.fal,
        [data-theme="light"] .teacher-content i.fab {
            color: #475569 !important; /* slate-600 */
        }
        
        /* Extra specificity */
        [data-theme="light"] .teacher-content *[class*="text-white"],
        [data-theme="light"] .teacher-content *.text-white {
            color: #475569 !important;
        }
        
        /* CRITICAL OVERRIDE: Force white text on green gradient Create buttons - highest priority */
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r *,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r i.fas,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r i.fa-plus,
        [data-theme="light"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r span,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r *,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r i.fas,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r i.fa-plus,
        [data-theme="light"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r span,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"],
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] *,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] i.fas,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] i.fa-plus,
        [data-theme="light"] .teacher-content button[class*="from-emerald-700"] span {
            color: #FFFFFF !important; /* Force white - must override all other rules */
        }
        
        /* DARK MODE: Force white text on green gradient Create buttons */
        [data-theme="dark"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r,
        [data-theme="dark"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r *,
        [data-theme="dark"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r i.fas,
        [data-theme="dark"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r i.fa-plus,
        [data-theme="dark"] .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r span,
        [data-theme="dark"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r,
        [data-theme="dark"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r *,
        [data-theme="dark"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r i.fas,
        [data-theme="dark"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r i.fa-plus,
        [data-theme="dark"] .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r span,
        [data-theme="dark"] .teacher-content button[class*="from-emerald-700"],
        [data-theme="dark"] .teacher-content button[class*="from-emerald-700"] *,
        [data-theme="dark"] .teacher-content button[class*="from-emerald-700"] i.fas,
        [data-theme="dark"] .teacher-content button[class*="from-emerald-700"] i.fa-plus,
        [data-theme="dark"] .teacher-content button[class*="from-emerald-700"] span,
        html.dark .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r,
        html.dark .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r *,
        html.dark .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r i.fas,
        html.dark .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r i.fa-plus,
        html.dark .teacher-content a[href*="teacher_lesson_create"].bg-gradient-to-r span,
        html.dark .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r,
        html.dark .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r *,
        html.dark .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r i.fas,
        html.dark .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r i.fa-plus,
        html.dark .teacher-content a[href*="teacher_quiz_create"].bg-gradient-to-r span {
            color: #FFFFFF !important; /* Force white in dark mode */
        }
        
        /* Subtitle text */
        [data-theme="light"] .teacher-content p.text-base,
        [data-theme="light"] .teacher-content p.text-lg,
        [data-theme="light"] .teacher-content p.text-sm {
            color: #334155 !important; /* slate-700 */
        }
        
        /* Stat labels/descriptions */
        [data-theme="light"] .teacher-content .text-xs,
        [data-theme="light"] .teacher-content .text-sm {
            color: #475569 !important; /* slate-600 */
        }
        
        [data-theme="light"] .teacher-content .text-slate-400 {
            color: #64748b !important; /* slate-500 */
        }
        
        /* Fallback for when .dark class is used instead of data-theme */
        body:not(.dark) .teacher-content,
        html:not(.dark) .teacher-content {
            color: #0f172a !important;
        }
        
        body:not(.dark) .teacher-content [class*="text-white"],
        html:not(.dark) .teacher-content [class*="text-white"],
        body:not(.dark) .teacher-content .text-slate-200,
        body:not(.dark) .teacher-content .text-slate-300,
        body:not(.dark) .teacher-content .text-slate-400 {
            color: #475569 !important;
        }
        
        body:not(.dark) .teacher-content h1,
        body:not(.dark) .teacher-content h2,
        body:not(.dark) .teacher-content h3,
        html:not(.dark) .teacher-content h1,
        html:not(.dark) .teacher-content h2,
        html:not(.dark) .teacher-content h3 {
            color: #0f172a !important;
        }
        
        /* Light mode: remove green tint from card backgrounds */
        [data-theme="light"] .bg-white\/5,
        [data-theme="light"] .bg-white\/3,
        [data-theme="light"] .bg-white\/8 {
            background-color: #FFFFFF !important;
        }
        
        /* Light mode: Ensure all headings are dark */
        [data-theme="light"] h1,
        [data-theme="light"] h2,
        [data-theme="light"] h3 {
            color: var(--text-primary) !important;
        }
        
        /* Light mode: Profile pill visibility */
        [data-theme="light"] button[onclick="toggleUserMenu()"] {
            background-color: rgba(10, 31, 31, 0.04) !important;
            border-color: rgba(10, 31, 31, 0.12) !important;
        }
        
        [data-theme="light"] button[onclick="toggleUserMenu()"]:hover {
            background-color: rgba(10, 31, 31, 0.08) !important;
            border-color: rgba(10, 31, 31, 0.2) !important;
        }
        
        /* Light mode: Dropdown menu items */
        [data-theme="light"] #user-menu a:hover {
            background-color: rgba(10, 31, 31, 0.06) !important;
        }
        
        /* Light mode: Dashboard link in navbar */
        [data-theme="light"] a[href*="teacher_dashboard"]:not(.sidebar-link) {
            color: var(--text-secondary) !important;
        }
        
        [data-theme="light"] a[href*="teacher_dashboard"]:not(.sidebar-link):hover {
            color: #5FA372 !important;
        }

        /* Theme-aware text colors */
        .text-theme-primary { color: var(--text-primary); }
        .text-theme-secondary { color: var(--text-secondary); }
        .text-theme-tertiary { color: var(--text-tertiary); }
        .text-theme-muted { color: var(--text-muted); }
        
        /* Theme-aware backgrounds */
        .bg-theme-secondary { background-color: var(--bg-secondary); }
        .bg-theme-elevated { background-color: var(--bg-elevated); }
        
        /* Theme-aware borders */
        .border-theme-primary { border-color: var(--border-primary); }
        
        /* UPDATED glass-card styles */
        .glass-card {
            background: rgba(255, 255, 255, 0.04);
            backdrop-filter: blur(16px);
            border-radius: 1rem;
        }

        [data-theme="light"] .glass-card {
            background: #FFFFFF !important;
            border-color: rgba(10, 31, 31, 0.12) !important;
            box-shadow: 0 2px 8px rgba(15, 23, 42, 0.05),
                        0 10px 25px rgba(15, 23, 42, 0.06) !important;
        }
        
        [data-theme="dark"] .glass-card,
        .dark .glass-card {
            background: rgba(15, 23, 42, 0.9) !important;
            border-color: rgba(148, 163, 184, 0.3) !important;
            box-shadow: 0 20px 45px rgba(15, 23, 42, 0.7) !important;
        }
        
        /* Light mode: Fix stat card backgrounds (kept) */
        [data-theme="light"] .glass-card .bg-white\/3,
        [data-theme="light"] .bg-white\/3 {
            background-color: rgba(250, 252, 251, 0.8) !important;
        }
        
        [data-theme="light"] .glass-card .bg-white\/3:hover,
        [data-theme="light"] .bg-white\/3:hover {
            background-color: rgba(245, 247, 246, 0.9) !important;
        }
        
        /* Base btn-cta-primary - matches Update Course button exactly */
        .btn-primary,
        .btn-cta-primary {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border-radius: 0.75rem;
            padding: 0.75rem 1.25rem;
            font-weight: 600;
            background-color: #10b981;
            color: white;
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.2);
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        
        /* Dark mode: Use same gradient as Update Course */
        [data-theme="dark"] .btn-cta-primary,
        html.dark .btn-cta-primary {
            background: linear-gradient(to right, #005a54, #75b088) !important;
            box-shadow: 0 10px 15px -3px rgba(130, 194, 147, 0.4), 0 4px 6px rgba(0, 0, 0, 0.3) !important;
        }
        
        /* Dark mode: Ensure white text */
        [data-theme="dark"] .btn-cta-primary,
        [data-theme="dark"] .btn-cta-primary *,
        [data-theme="dark"] .btn-cta-primary i,
        html.dark .btn-cta-primary,
        html.dark .btn-cta-primary *,
        html.dark .btn-cta-primary i {
            color: #FFFFFF !important;
        }
        
        /* Hover: same as Update Course */
        .btn-primary:hover:not(:disabled),
        .btn-cta-primary:hover:not(:disabled) {
            background-color: #34d399;
        }
        
        /* Dark mode hover: same as Update Course */
        [data-theme="dark"] .btn-cta-primary:hover:not(:disabled),
        html.dark .btn-cta-primary:hover:not(:disabled) {
            background: linear-gradient(to right, #00655F, #82C293) !important;
            box-shadow: 0 12px 20px -3px rgba(130, 194, 147, 0.5), 0 6px 8px rgba(0, 0, 0, 0.3) !important;
        }
        
        /* Active state */
        .btn-primary:active:not(:disabled),
        .btn-cta-primary:active:not(:disabled) {
            transform: scale(0.99);
        }
        
        /* Focus: same as Update Course */
        .btn-primary:focus-visible,
        .btn-cta-primary:focus-visible {
            outline: none;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.3), 0 10px 15px -3px rgba(16, 185, 129, 0.2);
        }
        
        .btn-primary:disabled,
        .btn-cta-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .btn-primary:disabled:hover,
        .btn-cta-primary:disabled:hover {
            background-color: #10b981;
            transform: none;
        }
        
        .btn-secondary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            height: 2.75rem;
            padding: 0 1.25rem;
            font-weight: 600;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            background-color: transparent;
            color: #334155;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .dark .btn-secondary,
        [data-theme="dark"] .btn-secondary {
            border-color: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }
        
        .btn-secondary:hover:not(:disabled) {
            background-color: #f8fafc;
            transform: translateY(-0.5px);
        }
        
        .dark .btn-secondary:hover:not(:disabled),
        [data-theme="dark"] .btn-secondary:hover:not(:disabled) {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .btn-secondary:active:not(:disabled) {
            transform: translateY(0);
        }
        
        .btn-secondary:focus-visible {
            outline: none;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.3);
        }
        
        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-danger {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            min-height: 44px;
            font-weight: 600;
            border-radius: 0.75rem;
            background: linear-gradient(to right, #dc2626, #ef4444);
            color: white;
            box-shadow: 0 4px 14px rgba(220, 38, 38, 0.3);
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .btn-danger:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4);
        }
        
        .btn-danger:active:not(:disabled) {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3);
        }
        
        .btn-danger:focus-visible {
            outline: none;
            box-shadow: 0 0 0 2px rgba(248, 113, 113, 0.5);
        }
        
        .btn-danger:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            color: #059669;
            text-decoration: none;
            transition: all 0.2s;
        }
        
        .dark .btn-link,
        [data-theme="dark"] .btn-link {
            color: #34d399;
        }
        
        .btn-link:hover {
            text-decoration: underline;
        }
        
        .btn-link:focus-visible {
            outline: none;
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.5);
            border-radius: 0.25rem;
        }
        
        /* Premium Form Inputs - Glass Effect in Dark, Clean White in Light */
        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            transition: all 0.2s;
            font-size: 0.9375rem;
            line-height: 1.5;
            outline: none;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.4), 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            border-color: rgba(16, 185, 129, 0.4);
        }
        
        .form-input:hover:not(:disabled),
        .form-select:hover:not(:disabled),
        .form-textarea:hover:not(:disabled) {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }
        
        .form-input:disabled,
        .form-select:disabled,
        .form-textarea:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* Light mode fields */
        .form-input,
        .form-select,
        .form-textarea {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            color: #0f172a;
        }
        
        .form-input::placeholder,
        .form-textarea::placeholder {
            color: #64748b;
        }
        
        /* Dark mode fields */
        .dark .form-input,
        .dark .form-select,
        .dark .form-textarea,
        [data-theme="dark"] .form-input,
        [data-theme="dark"] .form-select,
        [data-theme="dark"] .form-textarea {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #f1f5f9;
        }
        
        .dark .form-input::placeholder,
        .dark .form-textarea::placeholder,
        [data-theme="dark"] .form-input::placeholder,
        [data-theme="dark"] .form-textarea::placeholder {
            color: #94a3b8;
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        /* Premium Select */
        .form-select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 1.25em 1.25em;
            padding-right: 2.75rem;
        }
        
        [data-theme="dark"] .form-select,
        .dark .form-select {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
        }
        
        .form-select:focus {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%2310b981' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
        }
        
        .form-select option {
            background-color: #ffffff;
            color: #0f172a;
        }
        
        [data-theme="dark"] .form-select option,
        .dark .form-select option {
            background-color: #1e293b;
            color: #f1f5f9;
        }
        
        /* Invalid/Error State */
        .form-input:invalid,
        .form-textarea:invalid,
        .form-select:invalid,
        .form-input.error,
        .form-textarea.error,
        .form-select.error {
            border-color: rgba(248, 113, 113, 0.6);
        }
        
        .form-input:invalid:focus,
        .form-textarea:invalid:focus,
        .form-select:invalid:focus,
        .form-input.error:focus,
        .form-textarea.error:focus,
        .form-select.error:focus {
            box-shadow: 0 0 0 2px rgba(248, 113, 113, 0.15);
            border-color: rgba(248, 113, 113, 0.6);
        }
        
        /* Labels */
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.01em;
            margin-bottom: 0.625rem;
            color: #1e293b;
        }
        
        .dark .form-label,
        [data-theme="dark"] .form-label {
            color: #e2e8f0;
        }
        
        /* Helper Text */
        .form-helper {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            line-height: 1.625;
            color: #475569;
        }
        
        .dark .form-helper,
        [data-theme="dark"] .form-helper {
            color: rgba(203, 213, 225, 0.8);
        }
        
        /* Error Messages */
        .form-error {
            margin-top: 0.375rem;
            font-size: 0.875rem;
            color: #dc2626;
            background-color: #fef2f2;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #fecaca;
        }
        
        .dark .form-error,
        [data-theme="dark"] .form-error {
            color: #f87171;
            background-color: rgba(127, 29, 29, 0.2);
            border-color: rgba(127, 29, 29, 0.3);
        }
        
        /* Success Messages */
        .form-success {
            margin-top: 0.375rem;
            font-size: 0.875rem;
            color: #16a34a;
            background-color: #f0fdf4;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #bbf7d0;
        }
        
        .dark .form-success,
        [data-theme="dark"] .form-success {
            color: #4ade80;
            background-color: rgba(20, 83, 45, 0.2);
            border-color: rgba(20, 83, 45, 0.3);
        }
        
        /* Section header styles, checkboxes, etcâ€¦ (unchanged, keeping your original) */

        /* FINAL SAFETY NET: ensure text inside cards is always readable */
        .teacher-content .glass-card h1,
        .teacher-content .glass-card h2,
        .teacher-content .glass-card h3,
        .teacher-content .glass-card h4,
        .teacher-content .glass-card h5,
        .teacher-content .glass-card h6,
        .teacher-content .glass-card p,
        .teacher-content .glass-card span {
            color: #0f172a !important; /* dark in light mode */
        }

        [data-theme="dark"] .teacher-content .glass-card h1,
        [data-theme="dark"] .teacher-content .glass-card h2,
        [data-theme="dark"] .teacher-content .glass-card h3,
        [data-theme="dark"] .teacher-content .glass-card h4,
        [data-theme="dark"] .teacher-content .glass-card h5,
        [data-theme="dark"] .teacher-content .glass-card h6,
        [data-theme="dark"] .teacher-content .glass-card p,
        [data-theme="dark"] .teacher-content .glass-card span,
        .dark .teacher-content .glass-card h1,
        .dark .teacher-content .glass-card h2,
        .dark .teacher-content .glass-card h3,
        .dark .teacher-content .glass-card h4,
        .dark .teacher-content .glass-card h5,
        .dark .teacher-content .glass-card h6,
        .dark .teacher-content .glass-card p,
        .dark .teacher-content .glass-card span {
            color: #f9fafb !important; /* almost white in dark mode */
        }
        
        /* Premium Action Bar - Stripe/Linear/Notion style */
        /* Light mode: near-white glass surface */
        .action-bar-surface {
            background-color: rgba(255, 255, 255, 0.98) !important;
            backdrop-filter: blur(8px) !important;
            -webkit-backdrop-filter: blur(8px) !important;
            border-top: 1px solid rgba(130, 194, 147, 0.15) !important;
            box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.02) !important;
        }
        
        /* Dark mode: subtle dark glass */
        [data-theme="dark"] .action-bar-surface,
        html.dark .action-bar-surface {
            background-color: rgba(4, 54, 58, 0.7) !important;
            backdrop-filter: blur(8px) !important;
            -webkit-backdrop-filter: blur(8px) !important;
            border-top: 1px solid rgba(130, 194, 147, 0.1) !important;
            box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.2) !important;
        }
        
        /* Course Card Text Contrast - Force High Contrast in Dark Mode */
        /* Target course cards specifically - override any dimming from parent wrappers */
        /* Course Title - Must be near-white in dark mode (override ALL possible dimming) */
        [data-theme="dark"] .teacher-content .bg-white\/5 h3,
        [data-theme="dark"] .teacher-content .bg-white\/5 h3.text-xl,
        [data-theme="dark"] .teacher-content .bg-white\/5 h3.text-2xl,
        [data-theme="dark"] .teacher-content .bg-white\/5 h3[class*="text-xl"],
        [data-theme="dark"] .teacher-content .bg-white\/5 h3[class*="text-2xl"],
        [data-theme="dark"] .teacher-content .bg-white\/5 h3.dark\:text-slate-50,
        html.dark .teacher-content .bg-white\/5 h3,
        html.dark .teacher-content .bg-white\/5 h3.text-xl,
        html.dark .teacher-content .bg-white\/5 h3.text-2xl,
        html.dark .teacher-content .bg-white\/5 h3[class*="text-xl"],
        html.dark .teacher-content .bg-white\/5 h3[class*="text-2xl"],
        html.dark .teacher-content .bg-white\/5 h3.dark\:text-slate-50 {
            color: rgb(248, 250, 252) !important; /* slate-50 - near-white for maximum contrast */
            opacity: 1 !important;
        }
        
        /* Course Subtitle - Must be light gray (readable but muted) in dark mode */
        [data-theme="dark"] .teacher-content .bg-white\/5 p.text-sm,
        [data-theme="dark"] .teacher-content .bg-white\/5 p[class*="text-sm"],
        [data-theme="dark"] .teacher-content .bg-white\/5 p.dark\:text-slate-300,
        html.dark .teacher-content .bg-white\/5 p.text-sm,
        html.dark .teacher-content .bg-white\/5 p[class*="text-sm"],
        html.dark .teacher-content .bg-white\/5 p.dark\:text-slate-300 {
            color: rgb(203, 213, 225) !important; /* slate-300 - light gray, readable */
            opacity: 1 !important;
        }
        
        /* Remove any opacity dimming from course card parent wrappers */
        [data-theme="dark"] .teacher-content .bg-white\/5[class*="opacity"],
        [data-theme="dark"] .teacher-content .bg-white\/5 > div[class*="opacity"],
        html.dark .teacher-content .bg-white\/5[class*="opacity"],
        html.dark .teacher-content .bg-white\/5 > div[class*="opacity"] {
            opacity: 1 !important;
        }
        
        /* Create Course Button - Dark Mode Fix */
        [data-theme="dark"] .create-course-btn,
        html.dark .create-course-btn {
            color: rgb(255, 255, 255) !important; /* Force white text */
        }
        
        [data-theme="dark"] .create-course-btn span,
        [data-theme="dark"] .create-course-btn i,
        html.dark .create-course-btn span,
        html.dark .create-course-btn i {
            color: rgb(255, 255, 255) !important; /* Force white text on all elements */
        }
        
        [data-theme="dark"] .create-course-btn:hover,
        html.dark .create-course-btn:hover {
            filter: brightness(1.1) !important; /* Slight brightness lift on hover */
            box-shadow: 0 20px 25px -5px rgba(130, 194, 147, 0.4), 0 10px 10px -5px rgba(130, 194, 147, 0.2) !important;
        }
        
        [data-theme="dark"] .create-course-btn:focus,
        html.dark .create-course-btn:focus {
            outline: 2px solid rgba(130, 194, 147, 0.5) !important;
            outline-offset: 2px !important;
        }
    </style>
</head>
<body class="font-sans" style="background-color: var(--bg-primary); color: var(--text-primary);">
    {% include 'partials/role_preview_banner.html' %}
    {% include 'teacher/partials/navbar.html' %}
    
    <div class="flex min-h-[calc(100vh-4.5rem)] relative" {% if request.session.preview_role %}style="margin-top: 3.5rem; padding-top: 4.5rem;"{% else %}style="padding-top: 4.5rem;"{% endif %}>
        {% include 'teacher/partials/sidebar.html' %}
        
        <main class="flex-1 w-full lg:ml-56 pt-8 pb-6 px-6 sm:pt-10 sm:pb-8 sm:px-8 lg:pt-12 lg:pb-10 lg:px-10 teacher-content">
            {% if messages %}
                {% for message in messages %}
                    <div class="mb-4 p-4 rounded-lg {% if message.tags == 'error' %}bg-red-500/20 border border-red-500/50 text-red-200{% elif message.tags == 'success' %}bg-green-500/20 border border-green-500/50 text-green-200{% elif message.tags == 'warning' %}bg-yellow-500/20 border border-yellow-500/50 text-yellow-200{% else %}" style="background-color: var(--bg-secondary); border-color: var(--border-primary); color: var(--text-primary);"{% endif %}>
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
            
            {% block content %}{% endblock %}
        </main>
    </div>
</body>
</html>
