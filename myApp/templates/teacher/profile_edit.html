{% extends 'teacher/base.html' %}

{% block content %}
<div class="space-y-8 max-w-4xl mx-auto">
    <!-- Page Header -->
    <div class="mb-10">
        <h1 class="text-4xl sm:text-5xl font-bold mb-3 tracking-tight text-slate-900 dark:text-white">Edit Profile</h1>
        <p class="text-base sm:text-lg font-normal text-slate-700 dark:text-slate-300 tracking-wide">Update your profile information and photo</p>
    </div>
    
    <div class="h-px bg-gradient-to-r from-transparent via-slate-200 dark:via-white/10 to-transparent mb-8"></div>
    
    <!-- Profile Form Card -->
    <div class="glass-card backdrop-blur-xl rounded-2xl border border-slate-200 dark:border-white/10 bg-white dark:bg-slate-900 p-8 sm:p-10 shadow-md dark:shadow-2xl">
        <form method="post" enctype="multipart/form-data" class="space-y-8">
            {% csrf_token %}
            
            <!-- Photo Upload Section -->
            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-6 pb-8 border-b border-slate-200 dark:border-white/10">
                <div class="flex-shrink-0">
                    {% if teacher.photo_url %}
                    <img src="{{ teacher.photo_url }}" alt="Profile Photo" class="w-32 h-32 rounded-full object-cover border-4 border-slate-200 dark:border-white/10 shadow-lg">
                    {% else %}
                    <div class="w-32 h-32 rounded-full bg-slate-100 dark:bg-white/5 flex items-center justify-center border-4 border-slate-200 dark:border-white/10">
                        <i class="fas fa-user text-5xl text-slate-400 dark:text-slate-500"></i>
                    </div>
                    {% endif %}
                </div>
                <div class="flex-1">
                    <label for="photo" class="block text-sm font-semibold text-slate-900 dark:text-white mb-2">
                        Profile Photo
                    </label>
                    <input 
                        type="file" 
                        id="photo" 
                        name="photo" 
                        accept="image/*"
                        class="block w-full text-sm text-slate-900 dark:text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-50 dark:file:bg-emerald-500/20 file:text-emerald-700 dark:file:text-emerald-400 hover:file:bg-emerald-100 dark:hover:file:bg-emerald-500/30 cursor-pointer"
                    >
                    <p class="text-xs text-slate-500 dark:text-slate-500 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Image will be automatically converted to WebP format and optimized
                    </p>
                </div>
            </div>
            
            <!-- Personal Information -->
            <div>
                <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-6">Personal Information</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="first_name" class="form-label">First Name</label>
                        <input 
                            type="text" 
                            id="first_name" 
                            name="first_name" 
                            value="{{ user.first_name }}"
                            class="form-input"
                            required
                        >
                    </div>
                    <div>
                        <label for="last_name" class="form-label">Last Name</label>
                        <input 
                            type="text" 
                            id="last_name" 
                            name="last_name" 
                            value="{{ user.last_name }}"
                            class="form-input"
                            required
                        >
                    </div>
                    <div class="md:col-span-2">
                        <label for="email" class="form-label">Email</label>
                        <input 
                            type="email" 
                            id="email" 
                            name="email" 
                            value="{{ user.email }}"
                            class="form-input"
                            required
                        >
                    </div>
                </div>
            </div>
            
            <!-- Professional Information -->
            <div>
                <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-6">Professional Information</h2>
                <div class="space-y-6">
                    <div>
                        <label for="specialization" class="form-label">Specialization</label>
                        <input 
                            type="text" 
                            id="specialization" 
                            name="specialization" 
                            value="{{ teacher.specialization }}"
                            placeholder="e.g., Python, Web Development, Data Science"
                            class="form-input"
                        >
                    </div>
                    <div>
                        <label for="years_experience" class="form-label">Years of Experience</label>
                        <input 
                            type="number" 
                            id="years_experience" 
                            name="years_experience" 
                            value="{{ teacher.years_experience }}"
                            min="0"
                            class="form-input"
                        >
                    </div>
                    <div>
                        <label for="bio" class="form-label">Bio</label>
                        <textarea 
                            id="bio" 
                            name="bio" 
                            rows="6"
                            placeholder="Tell us about yourself, your teaching style, and what makes you unique..."
                            class="form-input"
                        >{{ teacher.bio }}</textarea>
                    </div>
                </div>
            </div>
            
            <!-- Submit Button -->
            <div class="flex items-center justify-end gap-4 pt-6 border-t border-slate-200 dark:border-white/10">
                <a href="{% url 'teacher_dashboard' %}" class="btn-secondary">
                    <i class="fas fa-times mr-2"></i>
                    Cancel
                </a>
                <button type="submit" class="btn-primary">
                    <i class="fas fa-save mr-2"></i>
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Preview image before upload
document.getElementById('photo').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const preview = document.querySelector('img[alt="Profile Photo"]') || 
                          document.querySelector('.w-32.h-32.rounded-full.bg-slate-100');
            if (preview && preview.tagName === 'IMG') {
                preview.src = e.target.result;
            } else if (preview) {
                // Replace placeholder div with img
                const img = document.createElement('img');
                img.src = e.target.result;
                img.alt = 'Profile Photo';
                img.className = 'w-32 h-32 rounded-full object-cover border-4 border-slate-200 dark:border-white/10 shadow-lg';
                preview.parentNode.replaceChild(img, preview);
            }
        };
        reader.readAsDataURL(file);
    }
});
</script>
{% endblock %}

